<div class="container mt-4">
  <h2 class="mb-3">{{ isEdit ? 'Modifier le Script' : 'Créer un Script' }}</h2>
  <form (ngSubmit)="submitForm()" class="row g-3">
    <div class="col-md-6">
      <label for="title" class="form-label">Titre</label>
      <input type="text" class="form-control" id="title" [(ngModel)]="form.title" name="title" required>
    </div>

    <div class="col-md-6">
      <label for="createdBy" class="form-label">Créé par</label>
      <input type="text" class="form-control" id="createdBy" [(ngModel)]="form.createdBy" name="createdBy" required>
    </div>

    <div class="col-md-6">
      <label for="type" class="form-label">Type</label>
      <select id="type" class="form-select" [(ngModel)]="form.type" name="type" required>
        <option value="PYTHON">Python</option>
        <option value="R">R</option>
        <option value="SQL">SQL</option>
      </select>
    </div>

    <div class="col-12">
      <label for="content" class="form-label">Contenu</label>
      <textarea id="content" class="form-control code-editor" [(ngModel)]="form.content" name="content" rows="10" required></textarea>
    </div>

    <!-- Sortie du script -->
    <div *ngIf="output">
      <app-execution-result
        [title]="form.title || 'Script sans titre'"
        [success]="!output.includes('Erreur:')"
        [output]="output"
        [error]="output.includes('Erreur:') ? output : ''">
      </app-execution-result>
    </div>
    <!-- Boutons -->
    <div class="col-12 d-flex justify-content-end gap-2">
      <button type="submit" class="btn btn-success">
        {{ isEdit ? 'Mettre à jour' : 'Créer' }}
      </button>
      <button type="button" class="btn btn-secondary" (click)="cancel()">
        Annuler
      </button>
    </div>

    <div class="mt-3 d-flex gap-2">
      <button class="btn btn-success" type="button" (click)="runCode()" [disabled]="isRunning">
        <i class="bi bi-play-fill"></i> Exécuter
      </button>

      <button class="btn btn-outline-primary" type="button" (click)="saveToFile()">
        <i class="bi bi-download"></i> Télécharger
      </button>

      <button class="btn btn-outline-secondary" type="button" (click)="clearEditor()">
        <i class="bi bi-trash3"></i> Effacer
      </button>
    </div>
  </form>
</div>
